# Common nginx configuration directives  
# These directives are included in server blocks (only general directives, no location blocks)

# Security headers
add_header X-Frame-Options DENY always;
add_header X-Content-Type-Options nosniff always;
add_header X-XSS-Protection "1; mode=block" always;
add_header Referrer-Policy "strict-origin-when-cross-origin" always;

# Gzip compression
gzip on;
gzip_vary on;
gzip_min_length 1024;
gzip_proxied expired no-cache no-store private auth;
gzip_types 
    text/plain 
    text/css 
    text/xml 
    text/javascript 
    application/javascript 
    application/xml+rss 
    application/json 
    image/svg+xml;

# Rate limiting (optional - commented out for development)
# limit_req_zone $binary_remote_addr zone=api:10m rate=10r/s;
# limit_req zone=api burst=20 nodelay;

# Client settings
client_max_body_size 10M;
client_body_timeout 60s;
client_header_timeout 60s;

# Proxy settings (used in location blocks)
proxy_set_header Host $host;
proxy_set_header X-Real-IP $remote_addr;
proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
proxy_set_header X-Forwarded-Proto $scheme;
proxy_cache_bypass $http_upgrade;
proxy_buffering off;